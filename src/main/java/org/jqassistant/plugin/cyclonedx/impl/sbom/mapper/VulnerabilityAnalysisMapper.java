package org.jqassistant.plugin.cyclonedx.impl.sbom.mapper;

import com.buschmais.jqassistant.core.scanner.api.Scanner;
import com.buschmais.jqassistant.plugin.common.api.mapper.DescriptorMapper;

import org.cyclonedx.model.vulnerability.Vulnerability;
import org.jqassistant.plugin.cyclonedx.api.model.sbom.VulnerabilityAnalysisDescriptor;
import org.mapstruct.Context;
import org.mapstruct.Mapper;
import org.mapstruct.Mapping;

@Mapper
public interface VulnerabilityAnalysisMapper extends DescriptorMapper<Vulnerability.Analysis, VulnerabilityAnalysisDescriptor> {

    @Override
    @Mapping(target = "state", source = "state.stateName")
    @Mapping(target = "justification", source = "justification.justificationName")
    VulnerabilityAnalysisDescriptor toDescriptor(Vulnerability.Analysis value, @Context Scanner scanner);

    default String map(Vulnerability.Analysis.Response response) {
        return response.getResponseName();
    }
}
